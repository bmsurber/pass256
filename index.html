<!DOCTYPE html>
<html lang="en" manifest="cache.manifest">
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width; initial-scale=1.0;
            maximum-scale=1.0; user-scalable=0;">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <title>Hashpass</title>
        <link rel='stylesheet' type='text/css' href='main.css'>
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <script type="text/javascript" src="sjcl.js"></script>
        <script type="text/javascript">
            document.ontouchmove = function(event){
            event.preventDefault();
            }
            function hashPass() {
                document.getElementById("submit").disabled = true;
                var parameters = document.getElementById("parameters").value;
                var password = document.getElementById("password").value;
                var length = document.getElementById("length").value;
                length = parseInt(length);
                length = length || 32;
                if (length > 42) {
                    length = 42;
                }
                var salt = sjcl.hash.sha256.hash(parameters);
                var dKey = sjcl.misc.pbkdf2(password, salt, 32768);
                var output = sjcl.codec.base64.fromBits(dKey);
                var dk = document.getElementById("dk");
                dk.value = output.substring(0,length);
                //copyText(dk.value);
                output = "";
                dKey = "";
                salt = "";
                password = "";
                parameters = "";
                document.getElementById("submit").disabled = false;
            }

            function copyText(text) {
                window.prompt("Copy to clipboard: Ctrl+C, Enter", text);
            }

        </script>
        </style>

    </head>
    <body>
        <div class="contentWrapper">
        <h1></h1>
        <form name="form1" autocomplete="off" onsubmit="">
            Master Password:<br>
            <input type="password" name="password" id="password" size="33"
                tabindex="1"><br>
            Account Info:<br>
            <input type="text" name="parameters" id="parameters" size="33"
                tabindex="2"><br>
            Generated Length:<br>
            <input type="text" name="length" id="length" value="32" size="3"
                maxlength="2" tabindex="3"><br>
            Generated Key:<br>
            <input type="text" name="dk" id="dk" size="33"
                onClick="this.setSelectionRange(0, this.value.length)"
                tabindex="6"><br><br>
            <input type="button" class="styled-button-0" value="Submit" name="submit" id="submit"
                onclick="hashPass();" tabindex="4">
            <input type=reset class="styled-button-1" onclick="return confirm('Are you sure you want to clear all fields?')" tabindex="5">
        </form>
    </div>
    </body>
</html>
